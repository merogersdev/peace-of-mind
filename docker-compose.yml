version: "3.8"

services:
  peaceofmind-db:
    image: peaceofmind-db
    container_name: peaceofmind-db
    build:
      context: ./db/
      target: db
    environment:
      - POSTGRES_USER=${{ secrets.POSTGRES_USER }}
      - POSTGRES_PASSWORD=${{ secrets.POSTGRES_PASSWORD}}
      - POSTGRES_DB=${{ secrets.POSTGRES_DB }}
      - POSTGRES_DB_TEST=${{ secrets.POSTGRES_DB_TEST }}
    volumes:
      - ./db/postgres:/var/lib/postgresql/data
    ports:
      - 5432:5432
  peaceofmind-backend:
    image: peaceofmind-backend
    container_name: peaceofmind-backend
    build:
      context: ./backend/
      target: backend
    ports:
      - 5000:5000
  peaceofmind-frontend:
    image: peaceofmind-frontend
    container_name: peaceofmind-frontend
    build:
      context: ./frontend/
      target: frontend
    ports:
      - 80:80
